export default function imageViewer(){let e=!1,t=1,n=!1,r=!1,a=0,s=0,i=0,o=0,l=0;const c=document.querySelector(".image-viewer-container"),d=c.querySelector("img"),m=e=>{document.body.style.overflow=e?"hidden":"auto",e?c.classList.add("active"):c.classList.remove("active")};let v=0;var u=e=>{n&&e.stopPropagation(),n=!1,d.style.cursor="grab"};d.addEventListener("wheel",(e=>{e.preventDefault();var n=d.getBoundingClientRect(),r=e.clientX-n.left,a=e.clientY-n.top;r-=n.width/2,a-=n.height/2,n=t;t+=-.001*e.deltaY,n<(t=Math.min(Math.max(.8,t),4))?(o-=r*(t-n),l-=a*(t-n)):(o=0,l=0),d.style.transform=`translate(${o}px, ${l}px) scale(${t})`}),{passive:!1}),d.addEventListener("mousedown",(e=>{e.preventDefault(),n=!0,s=e.clientX,i=e.clientY,d.style.cursor="grabbing"}),{passive:!1}),d.addEventListener("mousemove",(e=>{var a,c;!n||(a=(new Date).getTime())-v<100||(v=a,a=e.clientX-s,c=e.clientY-i,o+=a,l+=c,s=e.clientX,i=e.clientY,d.style.transform=`translate(${o}px, ${l}px) scale(${t})`,r=!0)}),{passive:!1}),d.addEventListener("mouseup",u,{passive:!1}),d.addEventListener("mouseleave",u,{passive:!1}),c.addEventListener("click",(n=>{r||(e=!1,m(e),t=1,o=0,l=0,d.style.transform=`translate(${o}px, ${l}px) scale(${t})`),r=!1}));const p=document.querySelectorAll(".markdown-body img, .masonry-item img, #shuoshuo-content img"),y=n=>{"Escape"===n.key&&e&&(e=!1,m(e),t=1,o=0,l=0,d.style.transform=`translate(${o}px, ${l}px) scale(${t})`,document.removeEventListener("keydown",y))};p.forEach(((t,n)=>{t.addEventListener("click",(()=>{a=n,e=!0,m(e),d.src=t.src,document.addEventListener("keydown",y)}))})),document.addEventListener("keydown",(t=>{if(e){if("ArrowUp"===t.key||"ArrowLeft"===t.key)a=(a-1+p.length)%p.length;else{if("ArrowDown"!==t.key&&"ArrowRight"!==t.key)return;a=(a+1)%p.length}let e=(t=p[a]).src;t.hasAttribute("lazyload")&&(e=t.getAttribute("data-src"),t.src=e,t.removeAttribute("lazyload")),d.src=e}})),!p.length&&c&&c.parentNode.removeChild(c)}