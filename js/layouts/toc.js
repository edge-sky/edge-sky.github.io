import{initTocToggle}from"../tools/tocToggle.js";import{main}from"../main.js";function initTOC(){const e={navItems:document.querySelectorAll(".post-toc-wrap .post-toc li"),updateActiveTOCLink(){if(Array.isArray(e.sections)){let t=e.sections.findIndex((e=>e&&0<e.getBoundingClientRect().top-100));-1===t?t=e.sections.length-1:0<t&&t--,this.activateTOCLink(t)}},registerTOCScroll(){e.sections=[...document.querySelectorAll(".post-toc li a.nav-link")].map((e=>document.getElementById(decodeURI(e.getAttribute("href")).replace("#",""))))},activateTOCLink(e){var t,o,i;(e=document.querySelectorAll(".post-toc li a.nav-link")[e])&&!e.classList.contains("active-current")&&(document.querySelectorAll(".post-toc .active").forEach((e=>{e.classList.remove("active","active-current")})),e.classList.add("active","active-current"),i=(t=document.querySelector(".toc-content-container")).getBoundingClientRect().top,o=t.offsetHeight>window.innerHeight?(t.offsetHeight-window.innerHeight)/2:0,i=e.getBoundingClientRect().top-i-Math.max(document.documentElement.clientHeight,window.innerHeight||0)/2+e.offsetHeight/2-o,e=t.scrollTop+i,t.scrollTo({top:e,behavior:"smooth"}))},showTOCAside(){var e="init_open";!theme.articles.toc.hasOwnProperty(e)||theme.articles.toc[e]?(()=>{var e=main.getStyleStatus(),t="isOpenPageAside";e&&e.hasOwnProperty(t)?initTocToggle().pageAsideHandleOfTOC(e[t]):initTocToggle().pageAsideHandleOfTOC(!0)})():initTocToggle().pageAsideHandleOfTOC(!1)}};return 0<e.navItems.length?(e.showTOCAside(),e.registerTOCScroll()):document.querySelectorAll(".toc-content-container, .toc-marker").forEach((e=>{e.remove()})),e}try{swup.hooks.on("page:view",(()=>{initTOC()}))}catch(e){}document.addEventListener("DOMContentLoaded",initTOC);export{initTOC};